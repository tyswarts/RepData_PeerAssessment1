---
title: "Activity"
author: "Ty Swarts"
date: "August 9, 2016"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
library(dplyr)
library(lubridate)
```

## R Markdown

Loading and preprocessing the data

```{r, echo=TRUE}
setwd("~/Coursera Data Class/Reproducible Data Analysis")
data<-read.csv("activity.csv", na.strings = "NA", header = TRUE)
```

#What is mean total number of steps taken per day?---------------------------------------------
#Daily Total
```{r, echo=TRUE}
Dtot<-aggregate(data[,1], list(data$date), sum)
#Histogram
```

```{r, echo=TRUE}
hist(Dtot$x)
```
#Mean
```{r, echo=TRUE}
Dmean<-aggregate(data[,1], list(data$date), mean)
Dmean
```
#Median
```{r, echo=TRUE}
Dmedian<-aggregate(data[,1], list(data$date), median)
Dmedian
```

#What is the average daily activity pattern?


```{r, echo=TRUE}
plot(data$interval,data$steps, type = "l")
```
#find max step count
```{r, echo=TRUE}
summary(data)
```
#search data interval with given high step count
```{r, echo=TRUE}
data$interval[data$steps=="806"]
```
#Imputing missing values----------------------------------------------------------------

#Caculate total number of NAs

```{r, echo=TRUE}
summary(data)

impute.mean <- function(x) replace(x, is.na(x), mean(x, na.rm = TRUE))

test<-data %>% mutate(steps = impute.mean(steps))
```

```{r, echo=TRUE}
hist(test$steps)
```

#Are there differences in activity patterns between weekdays and weekends?---------------------
```{r, echo=TRUE}
data$date<-ymd(data$date)

days<-weekdays(data$date)
```
#Assign weekdays to weekdays
```{r, echo=TRUE}
days<-replace(days, days=="Monday", "Weekday")
days<-replace(days, days=="Tuesday", "Weekday")
days<-replace(days, days=="Wednesday", "Weekday")
days<-replace(days, days=="Thursday", "Weekday")
days<-replace(days, days=="Friday", "Weekday")
days<-replace(days, days=="Saturday", "Weekend")
days<-replace(days, days=="Sunday", "Weekend")
data$days<-days
```
#filter Subsets
```{r, echo=TRUE}
weekend<-filter(data,days=="Weekend")
weekday<-filter(data,days=="Weekday")
```
#Plot Graphs
```{r, echo=TRUE}
plot(weekday$date,weekday$steps, col="blue", type = "l")
lines(weekend$date,weekend$steps, col="red", type = "l")
```
